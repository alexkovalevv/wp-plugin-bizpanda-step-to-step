!function(a){"use strict";var b=a.pandalocker.tools.extend(a.pandalocker.entity.group);b._defaults={order:["screen-message"],text:a.pandalocker.lang.subscription.defaultText},b.name="custom-screens",a.pandalocker.groups["custom-screens"]=b}(jQuery);
!function(a){"use strict";a.pandalocker.controls["custom-screens"]||(a.pandalocker.controls["custom-screens"]={});var b=a.pandalocker.tools.extend(a.pandalocker.entity.actionControl);b.name="screen-message",b.defaults={closeButton:!0,nextButton:!0,closeButtonText:"Close window",nextButtonText:"Next step"},b.prepareOptions=function(){this.options=a.extend(!0,this.defaults,this.options,this.locker.options.customScreens)},b.render=function(b){var c=this,d=a('<div class="onp-slp-control-buttons-line"></div>').appendTo(b),e=a('<a href="#" class="onp-sl-button onp-sl-button-primary onp-slp-close-button">'+this.options.closeButtonText+"</a>"),f=a('<a href="#" class="onp-sl-button onp-sl-button-primary onp-slp-next-button">'+this.options.nextButtonText+"</a>");e.click(function(){return a.pandalocker.hooks.run("opanda-step-to-step-force-unlock",[c.locker]),!1}),f.click(function(){return a.pandalocker.hooks.run("opanda-step-to-step-next-screen",[c.locker]),!1}),this.options.closeButton&&d.append(e),this.options.nextButton&&d.append(f)},a.pandalocker.controls["custom-screens"]["screen-message"]=b}(jQuery);
!function(a){"use strict";function b(b,c){var d="",e=a('<div class="onp-sts-progress-line"></div>');return c.stepToStep&&c.stepToStep["step"+b]&&(d=c.stepToStep["step"+b].title||""),e.append('<div class="onp-sts-step-mark onp-sts-step-'+b+'-mark"><span>ШАГ #'+b+"</span>"+d+"</div>"),e}a.pandalocker.step_to_step||(a.pandalocker.step_to_step={},a.pandalocker.step_to_step.needed=0,a.pandalocker.step_to_step.finish=0),a.pandalocker.hooks.add("opanda-filter-init-group-index",function(a,b,c){return b.options.stepToStep?0:a}),a.pandalocker.hooks.add("opanda-filter-init-group-options",function(b,c,d,e){if(!c.options.stepToStep)return b;d+=1;var f,g=a.pandalocker.tools.camelCase(e.name),h=c.options.stepToStep["step"+d];return h&&h.lockerOptions&&(f=a.extend({},h.lockerOptions),f[g]&&delete f[g],h.lockerOptions[g]&&(f=a.extend(f,h.lockerOptions[g])),b=a.extend(b,f)),b}),a.pandalocker.hooks.add("opanda-markup-created",function(b,c,d){if(c.options.stepToStep){c.screens["default"].remove();for(var e in c._screenFactory)if(c._screenFactory.hasOwnProperty(e)&&!(e.indexOf("step")<0)){if(!c._screenFactory[e]&&!c.screens[e])throw new a.pandalocker.error('The screen "'+e+'" not found in the group "'+e+'"');var f=a("<div class='onp-sl-screen onp-sl-screen-step onp-sl-screen-"+e+"'></div>").appendTo(c.innerWrap).hide();c.screens[e]=c._screenFactory[e](f)}}}),a.pandalocker.hooks.add("opanda-before-render-group-filter",function(a,b,c,d,e,f){return b.options.stepToStep?(c+=1,b.screens["default"]=b.defaultScreen=f["step-1"],b._currentScreenName="default",f["step-1"].show(),f["step-"+c]):a}),a.pandalocker.hooks.add("opanda-after-render-group",function(a,c,d,e){if(c.options.stepToStep){var f,g=c.options.groups&&c.options.groups.order;d+=1;for(var h=0;h<g.length;h++)f=b(h+1,c.options),d>=h+1?(e.element.before(f),f.find(".onp-sts-step-mark").addClass("onp-sts-top-line")):c.screens["step-"+d]&&c.screens["step-"+d].append(f)}}),a.pandalocker.hooks.add("opanda-init",function(b,c,d){if(c.options.stepToStep){var e=!1;if(c.options.groups&&c.options.groups.order&&c.options.groups.order.length){a.pandalocker.step_to_step.needed=c.options.groups.order.length;for(var f=0;f<c.options.groups.order.length;f++)c._registerScreen("step-"+(f+1),function(a,b){return a})}else e=!0;c.options.stepToStep.step1||(e=!0),e&&(c._lock=function(){return!1});var g=c._unlock;c._unlock=function(b,d,e){return["button","form"].indexOf(b)<0?void g.apply(c,[b,d,e]):void a.pandalocker.hooks.run("opanda-step-to-step-next-screen",[c])};var h=c.id;a.pandalocker.hooks.add("opanda-step-to-step-force-unlock",function(a){if(a.id==h){var b=a._getStateStorage();b.setState("onp_sts_unlocked","unlocked"),g.apply(a,[d,"step-to-step"])}}),a.pandalocker.hooks.add("opanda-step-to-step-next-screen",function(b){if(b.id==h){a.pandalocker.step_to_step.finish++;var c=b._getStateStorage(),e=a.pandalocker.step_to_step.finish,f=e+1,i=f-1;if(e>=a.pandalocker.step_to_step.needed)return c.setState("onp_sts_unlocked","unlocked"),g.apply(b,[d,"step-to-step"]),!1;if(b.screens["step-"+f])return b.screens["default"]=b.defaultScreen=b.screens["step-"+f],b._showScreen("step-"+f),b.locker.find(".onp-sts-step-"+i+"-mark").addClass("onp-sts-finish"),b.runHook("next-step",["step-"+f],!0),!1;c.setState("onp_sts_unlocked","unlocked"),g.apply(b,[d,"step-to-step"])}})}}),a.pandalocker.hooks.add("opanda-functions-requesting-state",function(a,b){return a.push(function(a){var c=b._getStateStorage();a(c.isUnlocked("onp_sts_unlocked")?"unlocked":"locked")}),a})}(jQuery);